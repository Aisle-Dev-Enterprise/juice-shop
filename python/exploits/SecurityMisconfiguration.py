import requests


def replicate_security_misconfiguration(juiceshop_url):
    """Replicates the Security Misconfiguration security risk on Juice Shop.
       Security risk is invoked by trying to open/upload a file that is not .pdf or .zip file.
       Security risk exposes Express version. """
    error_url = juiceshop_url+r"/ftp/eastere.gg"
    try:
        response = requests.get(error_url)

        return response.text
    except requests.exceptions.Timeout as et:
        return "Timeout Error"
    except requests.exceptions.HTTPError as eh:
        return "HTTP Error"
    except requests.exceptions.ConnectionError as ec:
        return "Connection Error"


def security_misconfiguration_fix_passfail(juiceshop_url):
    """ Checks if the Security Misconfiguration security risk has been successfully patched for Juice Shop.
        Returns True if Error message has been fixed, or False if still includes sensitive data. """
    response_text = replicate_security_misconfiguration(juiceshop_url)
    fix_check = True
    if "Express" in response_text:
        fix_check = False

    return fix_check


if __name__ == '__main__':
    url = r"http://localhost:3000"
    print(security_misconfiguration_fix_passfail(url))
